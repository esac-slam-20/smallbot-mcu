# 通讯协议

## 基础格式

```
0x55 <CMD> <LEN> <DAT> <CRC> 0xAA
```

其中：
- CMD: 1 Byte, 指示当前命令
- LEN: 1 Byte, 指示接下来的数据长度
- DAT: 数据，长度由 LEN 规定。
- CRC: 2 Byte, 是从 CMD 到 DAT 最后一位的CRC校验和。

所有的数据都是小端序，即低字节放在前面：0x0123 表示为 0x23 0x01

CRC校验和暂时不做，请保证其为 0x00 0x00

## 下发命令

### 0x10 设置运动速度

数据格式：

```
<SPD> <DIR> <ROT>
```

其中：
- SPD: 小车线速度。类型为uint16_t, 单位为 mm/s
- DIR: 小车线速度方向。类型为int16_t，单位为 rad*1000。请保证数据范围 [-3141, 3141]
- ROT: 小车自转速度。类型为int16_t, 单位为 rad*1000/s

> 示例：
> 
> 小车向前运动0.5 m/s, 同时以0.3 rad/s 的速度自转
>
> ```
> 0x55 0x10 0x06 0xF4 0x01 0x00 0x00 0x2C 0x01 0x00 0x00 0xAA
> ```
>

## 上发命令

### 0x00 ACK 命令已收到

无附加数据。

收到此命令，意味着小车已经收到了下发的命令。若长时间未收到此命令，请尝试重发上一次的数据。

### 0x01 NACK 命令接收错误

无附加数据。

收到此命令，意味着小车虽然收到了下发的命令，但无法执行。可能的原因是CRC校验和出错，请尝试重发。

### 0x02 INVALID ARGS 命令参数错误

无附加数据。

收到此命令，意味着小车虽然收到了下发的命令，但无法执行。可能的原因是命令参数长度出错，请检查命令是否正确，或尝试重发。

### 0x80 ODOM 小车编码器数值

数据格式：

```
<ODOM1> <ODOM2> <ODOM3> <ODOM4>
```

其中：
- ODOMx: 编码器数据。数据类型为int32_t, 单位为Tick

